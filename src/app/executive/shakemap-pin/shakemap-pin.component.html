<basic-pin
    [link]="link"
    [product]="product">
  <div card-title>
    <a [routerLink]="link">{{ title }}</a>
    <shared-mmi
        *ngIf="product | sharedProductContent:
        'download/pin-thumbnail.png'"
        [bubble]="true"
        [intensity]="product?.properties?.maxmmi">
    </shared-mmi>
  </div>

  <figure
      *ngIf="product | sharedProductContent:
      'download/pin-thumbnail.png' as image; else noImage">
    <img src="{{ image.url }}" alt="ShakeMap Intensity Thumbnail" />
    <figcaption>
      <ng-container *ngIf="product?.properties?.maxmmi as mmi; else noMMI">
        Perceived Shaking: {{ mmiDescription[round(mmi)].shaking }}
        Potential Damage: {{ mmiDescription[round(mmi)].damage }}
      </ng-container>
    </figcaption>
  </figure>

  <ng-template #noImage>
    <dl *ngIf="product?.properties?.maxmmi as mmi; else noMMI">
      <dt>Estimated Intensity</dt>
      <dd>
        <shared-mmi
          [bubble]="true"
          [intensity]="mmi">
        </shared-mmi>
      </dd>
      <dt>Perceived Shaking</dt>
      <dd>{{ mmiDescription[round(mmi)].shaking }}</dd>

      <dt>Potential Damage</dt>
      <dd>{{ mmiDescription[round(mmi)].damage }}</dd>
    </dl>
  </ng-template>

  <ng-template #noMMI>
    <p class="alert error">
      Estimated Intensity not specified.
    </p>
  </ng-template>

</basic-pin>
